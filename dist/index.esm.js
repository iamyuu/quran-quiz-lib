import{z as e}from"zod";import*as r from"fs";let t=e.object({id:e.number(),verse_number:e.number(),verse_key:e.string(),juz_number:e.number(),hizb_number:e.number(),rub_el_hizb_number:e.number(),ruku_number:e.number(),manzil_number:e.number(),sajdah_number:e.nullable(e.number()),chapter_id:e.number(),text_imlaei:e.string(),text_uthmani:e.string(),page_number:e.number()}),n=()=>{let n=e.object({verses:e.array(t)}).safeParse(JSON.parse(r.readFileSync("./src/data/quran.json","utf-8")));if(!n.success)throw Error("Failed to parse data");return n.data.verses},a=e=>n().reduce((r,t)=>(e.includes(t.chapter_id)&&r.push(t.id),r),[]),u=e=>{let r=n().find(r=>r.id===e);if(!r)throw Error("Failed to find verse");return r.text_uthmani};function o(){return(o=Object.assign||function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e}).apply(this,arguments)}let s=e=>{if(e.length<5)throw Error("Not enough numbers");let r=Math.floor(Math.random()*(e.length-1)),t=[e[r],e[r+1]],n=e.filter((e,t)=>t!==r&&t!==r+1);if(n.length<3)throw Error("Not enough remaining numbers");let a=[];for(let e=0;e<3;e++){let e=Math.floor(Math.random()*n.length);a.push(n[e]),n.splice(e,1)}return{question:t[0],answer:t[1],options:a}},i=e=>{let{indexOf:r,getter:t}=e,n={question:t(r.question),options:[...r.options.map(e=>({text:t(e),value:0})),{text:t(r.answer),value:1}]};return l(n)},l=e=>{let r=[...e.options];for(let e=r.length-1;e>0;e--){let t=Math.floor(Math.random()*(e+1));[r[e],r[t]]=[r[t],r[e]]}return o({},e,{options:r})},m=e=>e.sort((e,r)=>e-r),b=r=>{let t=e.object({select:e.array(e.number({invalid_type_error:"Must be number"}).min(1,"Must be between 1 and 114").max(114,"Must be between 1 and 114")).min(1,"Select at least one chapter"),amount:e.number().min(1)}),n=t.parse(r),{select:o,amount:l}=n,b=a(o),h=[];for(let e=0;e<l;e++){let{answer:e,options:r,question:t}=s(b),n=i({indexOf:{answer:e,options:r,question:t},getter:u});h.push(n)}return{data:h,meta:{type:"guessVerseByChapter",select:m(o),amount:l}}},h={byChapter:b};export{h as guessVerse};
